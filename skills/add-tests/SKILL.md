# Skill: add-tests（テスト追加）

## 目的

変更対象の受入基準を満たすテスト（自動）を追加し、回帰を抑止する。

## 入力（必須）

- 対象の仕様/受入基準（何が保証されるべきか）
- 対象範囲（モジュール、API、UI、CLI など）
- 制約（実行時間、外部依存、変更禁止領域）
- テスト環境（実行コマンド、必要な fixture、Secrets の扱い）

## 出力（成果物）

- 追加/更新されたテストコード
- テスト実行結果（CI/ローカルの証跡）
- 必要ならドキュメント（テストの意図、実行方法）

## 手順

1. 受入基準をテスト観点に分解する
   - 正常系/異常系/境界条件/セキュリティ観点（入力検証等）を整理
2. テストの粒度を決める
   - ユニット/統合/E2E を選択し、コストと再現性を優先して設計
3. 既存テストのパターンに合わせて実装する
   - テストフレームワーク、命名、fixture の流儀を踏襲
4. 失敗時の診断性を担保する
   - 期待/実際が差分で分かるアサーション、ログ、スナップショットを整備
5. 実行して安定性を確認する

## チェック（品質ゲート）

- [ ] 受入基準に対応するテストが存在する
- [ ] 再現性があり、外部要因でフレークしにくい
- [ ] 実行時間/コストが許容範囲
- [ ] テスト実行手順が明記されている

## 失敗時の対応

- フレーク: 非決定要因（時間、乱数、ネットワーク）を排除し、安定化する
- コスト過大: 粒度を下げる、重いテストは nightly に移す等の分離を提案する

