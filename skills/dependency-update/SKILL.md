# Skill: dependency-update（依存更新）

## 目的

依存関係の更新を「理由・影響・検証・ロールバック」を含む実行仕様として固定し、安全に適用する。

## 入力（必須）

- 更新対象（パッケージ名/現在バージョン/目標バージョン/更新範囲）
- 変更理由（脆弱性対応、互換性、機能要件など）と一次情報（リリースノート等）
- 制約（互換性維持、サポート対象、変更禁止領域）
- テスト計画（コマンド、期待結果、手動確認の要否）

## 出力（成果物）

- 依存更新 PR（差分は最小化）
- 影響評価（破壊的変更の有無、移行が必要なら手順）
- 検証結果（CI 結果、実行ログ、再現手順）
- ロールバック手順（revert / version pin / lockfile 復元）

## 手順

1. 仕様を固定する
   - 対象/理由/制約/受入基準/テスト/ロールバックが Issue に揃っているか確認
2. 変更影響を調査する
   - 変更点（CHANGELOG/Release note）を読み、破壊的変更と移行要否を整理
3. 更新を適用する
   - lockfile を含めて更新し、差分を最小化（不要なフォーマット変更は避ける）
4. 検証する
   - `lint/test/build` を実行し、失敗時は原因を分離（依存更新起因か、既存不具合か）
5. 仕上げる
   - PR 本文に「理由」「影響」「検証」「ロールバック」を記載

## チェック（品質ゲート）

- [ ] 受入基準に合致している
- [ ] 破壊的変更がある場合、影響と移行手順が明記されている
- [ ] CI が PASS している（必要な範囲）
- [ ] ロールバック手順が実行可能である

## 失敗時の対応

- CI 失敗: 失敗箇所の最小再現を作り、依存更新との差分で原因を特定
- 破壊的変更: 目標バージョンを下げる/段階的更新に分割する
- ロールバック: PR revert、または version pin / lockfile 復元

